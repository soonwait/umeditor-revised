<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>UMeditor Revised Plugin</title>
    <link href="https://ueditor.baidu.com/umeditor/themes/default/css/umeditor.min.css" type="text/css"
        rel="stylesheet">
    <script type="text/javascript" charset="utf-8"
        src="https://ueditor.baidu.com/umeditor/third-party/jquery.min.js"></script>
    <script type="text/javascript" charset="utf-8"
        src="https://ueditor.baidu.com/umeditor/third-party/template.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="https://ueditor.baidu.com/umeditor/umeditor.config.js"></script>
    <script type="text/javascript" charset="utf-8" src="https://ueditor.baidu.com/umeditor/umeditor.js"></script>
    <script type="text/javascript" charset="utf-8"
        src="https://ueditor.baidu.com/umeditor/lang/zh-cn/zh-cn.js"></script>

</head>

<body>
    <script type="text/plain" id="editor" style="width: 100%; height: 260px;"></script>
    <div
        style="width: 100%; height: 160px; overflow: hidden scroll; border: 1px solid #d4d4d4; box-shadow: 2px 2px 5px #d3d6da; background-color: #fff;">
        <pre id="sss"></pre>
    </div>
    <div
        style="width: 100%; height: 160px; overflow: hidden scroll; border: 1px solid #d4d4d4; box-shadow: 2px 2px 5px #d3d6da; background-color: #fff;">
        <pre id="sss1"></pre>
    </div>

    <script type="text/javascript">
        UM.plugins["font"] = function () { }
        // UM.plugins['basestyle'] = function() {}
        UM.plugins["showmsg"] = function () {
            var me = this;
            me.addListener('contentChange', function () {
                // var html = this.getContent();
                var html = this.body.innerHTML;
                document.getElementById('sss').innerText = html.split('</p><p').join('</p>\n<p');
                document.getElementById('sss1').innerText = this.getContent().split('</p><p').join('</p>\n<p');
            });
        };


        var serverPath = 'https://ueditor.baidu.com/server/umeditor/',
            um = UM.getEditor('editor', {
                imageUrl: serverPath + "imageUp.php",
                imagePath: serverPath,
                lang: /^zh/.test(navigator.language || navigator.browserLanguage || navigator.userLanguage) ? 'zh-cn' : 'en',
                langPath: UMEDITOR_CONFIG.UMEDITOR_HOME_URL + "lang/",
                focus: true,
                /* 传入配置参数,可配参数列表看umeditor.config.js */
                toolbar: ['source | undo redo | selectall cleardoc | bold italic underline | justifyleft justifycenter justifyright | emotion image video map | horizontal print preview fullscreen']
                // toolbar: ['undo redo | bold italic underline']
            });

        function insertHtml() {
            var value = prompt('插入html代码', '');
            um.execCommand('insertHtml', value)
        }
        function getAllHtml() {
            alert(UM.getEditor('editor').getAllHtml())
        }
        function getContent() {
            var arr = [];
            arr.push("使用editor.getContent()方法可以获得编辑器的内容");
            arr.push("内容为：");
            arr.push(UM.getEditor('editor').getContent());
            alert(arr.join("\n"));
        }
        function isFocus() {
            alert(um.isFocus())
        }
        function doBlur() {
            um.blur()
        }
        function getPlainTxt() {
            var arr = [];
            arr.push("使用editor.getPlainTxt()方法可以获得编辑器的带格式的纯文本内容");
            arr.push("内容为：");
            arr.push(UM.getEditor('editor').getPlainTxt());
            alert(arr.join('\n'))
        }
        function setContent(isAppendTo) {
            var arr = [];
            arr.push("使用editor.setContent('欢迎使用umeditor', true)方法可以设置编辑器的内容");
            UM.getEditor('editor').setContent('欢迎使用umeditor', isAppendTo);
            alert(arr.join("\n"));
        }
        function setDisabled() {
            UM.getEditor('editor').setDisabled('fullscreen');
            disableBtn("enable");
        }

        function setEnabled() {
            UM.getEditor('editor').setEnabled();
            enableBtn();
        }

        function getText() {
            //当你点击按钮时编辑区域已经失去了焦点，如果直接用getText将不会得到内容，所以要在选回来，然后取得内容
            var range = UM.getEditor('editor').selection.getRange();
            range.select();
            var txt = UM.getEditor('editor').selection.getText();
            alert(txt)
        }

        function getContentTxt() {
            var arr = [];
            arr.push("使用editor.getContentTxt()方法可以获得编辑器的纯文本内容");
            arr.push("编辑器的纯文本内容为：");
            arr.push(UM.getEditor('editor').getContentTxt());
            alert(arr.join("\n"));
        }
        function hasContent() {
            var arr = [];
            arr.push("使用editor.hasContents()方法判断编辑器里是否有内容");
            arr.push("判断结果为：");
            arr.push(UM.getEditor('editor').hasContents());
            alert(arr.join("\n"));
        }
        function setFocus() {
            UM.getEditor('editor').focus();
        }
        function deleteEditor() {
            disableBtn();
            UM.getEditor('editor').destroy();
        }
        function disableBtn(str) {
            var div = document.getElementById('btnContainer');
            var btns = UM.dom.domUtils.getElementsByTagName(div, "button");
            for (var i = 0, btn; btn = btns[i++];) {
                if (btn.id == str) {
                    UM.dom.domUtils.removeAttributes(btn, ["disabled"]);
                } else {
                    $(btn).attr("disabled", true).addClass("disabled");
                }
            }
        }
        function enableBtn() {
            var div = document.getElementById('btnContainer');
            var btns = UM.dom.domUtils.getElementsByTagName(div, "button");
            for (var i = 0, btn; btn = btns[i++];) {
                $(btn).removeAttr("disabled").removeClass("disabled");
            }
        }

        window.onkeydown = function (e) {
            if (!um.isFocus()) {
                var keyCode = e.keyCode || e.which;
                if (keyCode == 8) {
                    e.preventDefault();
                }
            }
        };

    </script>
</body>

</html>